<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 900" width="1400" height="900">
  <defs>
    <!-- Arrowhead markers -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#d32f2f"/>
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1976d2"/>
    </marker>
    
    <!-- Background pattern -->
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e8e8e8" stroke-width="0.5"/>
    </pattern>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="900" fill="#fafafa"/>
  <rect width="1400" height="900" fill="url(#grid)"/>
  
  <!-- Title Block -->
  <rect x="10" y="10" width="1380" height="60" rx="5" fill="#1a237e" opacity="0.9"/>
  <text x="700" y="45" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="white">STM32 Robot Vacuum Motor Control Schematic</text>
  <text x="1350" y="45" font-family="Arial, sans-serif" font-size="12" text-anchor="end" fill="#90caf9">Rev 1.0 | 2025.01</text>
  
  <!-- ==================== SECTION 1: POWER INPUT ==================== -->
  <rect x="20" y="85" width="200" height="150" rx="8" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  <text x="120" y="105" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#1976d2">전원 입력부</text>
  
  <!-- AC-DC Adapter Symbol -->
  <rect x="40" y="120" width="80" height="50" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="80" y="145" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">AC-DC</text>
  <text x="80" y="160" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666">24V/3A</text>
  
  <!-- Input Diode D1 (SS24) -->
  <polygon points="150,135 170,145 150,155" fill="none" stroke="#333" stroke-width="1.5"/>
  <line x1="170" y1="135" x2="170" y2="155" stroke="#333" stroke-width="1.5"/>
  <line x1="120" y1="145" x2="150" y2="145" stroke="#d32f2f" stroke-width="2"/>
  <line x1="170" y1="145" x2="200" y2="145" stroke="#d32f2f" stroke-width="2"/>
  <text x="160" y="128" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#333">D1</text>
  <text x="160" y="172" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">SS24</text>
  
  <!-- ==================== SECTION 2: POWER REGULATION ==================== -->
  <rect x="230" y="85" width="280" height="150" rx="8" fill="#e8f5e9" stroke="#388e3c" stroke-width="2"/>
  <text x="370" y="105" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#388e3c">전압 레귤레이터</text>
  
  <!-- 12V Regulator -->
  <rect x="250" y="120" width="70" height="45" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="285" y="142" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">LM7812</text>
  <text x="285" y="156" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">U2</text>
  <text x="252" y="138" font-family="Arial, sans-serif" font-size="7" fill="#333">IN</text>
  <text x="310" y="138" font-family="Arial, sans-serif" font-size="7" fill="#333">OUT</text>
  <text x="285" y="170" font-family="Arial, sans-serif" font-size="7" fill="#333">GND</text>
  
  <!-- 5V Regulator (7805) -->
  <rect x="350" y="120" width="70" height="45" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="385" y="142" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">7805</text>
  <text x="385" y="156" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">U1</text>
  <text x="352" y="138" font-family="Arial, sans-serif" font-size="7" fill="#333">IN</text>
  <text x="410" y="138" font-family="Arial, sans-serif" font-size="7" fill="#333">OUT</text>
  
  <!-- 3.3V LDO -->
  <rect x="440" y="120" width="60" height="45" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="470" y="142" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">AMS1117</text>
  <text x="470" y="156" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">3.3V</text>
  
  <!-- Power connections -->
  <line x1="200" y1="145" x2="250" y2="145" stroke="#d32f2f" stroke-width="2"/>
  <line x1="320" y1="142" x2="350" y2="142" stroke="#ff9800" stroke-width="2"/>
  <line x1="420" y1="142" x2="440" y2="142" stroke="#4caf50" stroke-width="2"/>
  
  <!-- Capacitors C1 -->
  <line x1="240" y1="185" x2="240" y2="195" stroke="#333" stroke-width="2"/>
  <line x1="240" y1="200" x2="240" y2="210" stroke="#333" stroke-width="2"/>
  <line x1="235" y1="195" x2="245" y2="195" stroke="#333" stroke-width="1.5"/>
  <line x1="235" y1="200" x2="245" y2="200" stroke="#333" stroke-width="1.5"/>
  <text x="255" y="200" font-family="Arial, sans-serif" font-size="8" fill="#666">C1 100µF</text>
  <line x1="240" y1="165" x2="240" y2="185" stroke="#333" stroke-width="1"/>
  
  <!-- Power rail labels -->
  <circle cx="200" cy="145" r="4" fill="#d32f2f"/>
  <text x="200" y="130" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#d32f2f" font-weight="bold">24V</text>
  
  <circle cx="320" cy="142" r="4" fill="#ff9800"/>
  <text x="320" y="127" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#ff9800" font-weight="bold">12V</text>
  
  <circle cx="420" cy="142" r="4" fill="#4caf50"/>
  <text x="420" y="127" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#4caf50" font-weight="bold">5V</text>
  
  <circle cx="500" cy="142" r="4" fill="#2196f3"/>
  <text x="500" y="127" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#2196f3" font-weight="bold">3.3V</text>
  
  <!-- ==================== SECTION 3: STM32 MCU ==================== -->
  <rect x="520" y="85" width="320" height="280" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="2"/>
  <text x="680" y="105" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#e65100">MCU - STM32F103C8T6</text>
  
  <!-- MCU IC Body -->
  <rect x="580" y="115" width="200" height="230" rx="5" fill="white" stroke="#333" stroke-width="2"/>
  <text x="680" y="225" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">STM32F103</text>
  <text x="680" y="242" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">LQFP-48</text>
  <circle cx="595" y="130" r="5" fill="none" stroke="#333" stroke-width="1"/>
  
  <!-- Left side pins -->
  <line x1="550" y1="135" x2="580" y2="135" stroke="#2196f3" stroke-width="1.5"/>
  <text x="583" y="138" font-family="Arial, sans-serif" font-size="8" fill="#333">VDD</text>
  
  <line x1="550" y1="155" x2="580" y2="155" stroke="#333" stroke-width="1.5"/>
  <text x="583" y="158" font-family="Arial, sans-serif" font-size="8" fill="#333">NRST</text>
  
  <line x1="550" y1="175" x2="580" y2="175" stroke="#9c27b0" stroke-width="1.5"/>
  <text x="583" y="178" font-family="Arial, sans-serif" font-size="8" fill="#333">PA0/TIM2_CH1</text>
  
  <line x1="550" y1="195" x2="580" y2="195" stroke="#9c27b0" stroke-width="1.5"/>
  <text x="583" y="198" font-family="Arial, sans-serif" font-size="8" fill="#333">PA1/TIM2_CH2</text>
  
  <line x1="550" y1="215" x2="580" y2="215" stroke="#009688" stroke-width="1.5"/>
  <text x="583" y="218" font-family="Arial, sans-serif" font-size="8" fill="#333">PA2/USART2_TX</text>
  
  <line x1="550" y1="235" x2="580" y2="235" stroke="#009688" stroke-width="1.5"/>
  <text x="583" y="238" font-family="Arial, sans-serif" font-size="8" fill="#333">PA3/USART2_RX</text>
  
  <line x1="550" y1="255" x2="580" y2="255" stroke="#ff5722" stroke-width="1.5"/>
  <text x="583" y="258" font-family="Arial, sans-serif" font-size="8" fill="#333">PA8/TIM1_CH1</text>
  
  <line x1="550" y1="275" x2="580" y2="275" stroke="#ff5722" stroke-width="1.5"/>
  <text x="583" y="278" font-family="Arial, sans-serif" font-size="8" fill="#333">PA9/TIM1_CH2</text>
  
  <line x1="550" y1="295" x2="580" y2="295" stroke="#ff5722" stroke-width="1.5"/>
  <text x="583" y="298" font-family="Arial, sans-serif" font-size="8" fill="#333">PA10/TIM1_CH3</text>
  
  <line x1="550" y1="315" x2="580" y2="315" stroke="#ff5722" stroke-width="1.5"/>
  <text x="583" y="318" font-family="Arial, sans-serif" font-size="8" fill="#333">PA11/TIM1_CH4</text>
  
  <!-- Right side pins -->
  <line x1="780" y1="135" x2="810" y2="135" stroke="#795548" stroke-width="1.5"/>
  <text x="717" y="138" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PB0/ADC_IN8</text>
  
  <line x1="780" y1="155" x2="810" y2="155" stroke="#795548" stroke-width="1.5"/>
  <text x="717" y="158" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PB1/ADC_IN9</text>
  
  <line x1="780" y1="175" x2="810" y2="175" stroke="#607d8b" stroke-width="1.5"/>
  <text x="717" y="178" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PB6/I2C1_SCL</text>
  
  <line x1="780" y1="195" x2="810" y2="195" stroke="#607d8b" stroke-width="1.5"/>
  <text x="717" y="198" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PB7/I2C1_SDA</text>
  
  <line x1="780" y1="215" x2="810" y2="215" stroke="#e91e63" stroke-width="1.5"/>
  <text x="717" y="218" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PB10/USART3_TX</text>
  
  <line x1="780" y1="235" x2="810" y2="235" stroke="#e91e63" stroke-width="1.5"/>
  <text x="717" y="238" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PB11/USART3_RX</text>
  
  <line x1="780" y1="255" x2="810" y2="255" stroke="#8bc34a" stroke-width="1.5"/>
  <text x="717" y="258" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PC13/LED</text>
  
  <line x1="780" y1="275" x2="810" y2="275" stroke="#00bcd4" stroke-width="1.5"/>
  <text x="717" y="278" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PA13/SWDIO</text>
  
  <line x1="780" y1="295" x2="810" y2="295" stroke="#00bcd4" stroke-width="1.5"/>
  <text x="717" y="298" font-family="Arial, sans-serif" font-size="8" text-anchor="end" fill="#333">PA14/SWCLK</text>
  
  <line x1="550" y1="335" x2="580" y2="335" stroke="#333" stroke-width="1.5"/>
  <text x="583" y="338" font-family="Arial, sans-serif" font-size="8" fill="#333">VSS/GND</text>
  
  <!-- Power connection to MCU -->
  <line x1="500" y1="142" x2="530" y2="142" stroke="#2196f3" stroke-width="2"/>
  <line x1="530" y1="142" x2="530" y2="135" stroke="#2196f3" stroke-width="2"/>
  <line x1="530" y1="135" x2="550" y2="135" stroke="#2196f3" stroke-width="2"/>
  
  <!-- ==================== SECTION 4: MOTOR DRIVER ==================== -->
  <rect x="850" y="85" width="280" height="200" rx="8" fill="#fce4ec" stroke="#c2185b" stroke-width="2"/>
  <text x="990" y="105" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#c2185b">모터 드라이버 (H-Bridge)</text>
  
  <!-- L298N Driver -->
  <rect x="880" y="120" width="120" height="80" rx="5" fill="white" stroke="#333" stroke-width="2"/>
  <text x="940" y="155" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">L298N</text>
  <text x="940" y="172" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666">Dual H-Bridge</text>
  <text x="940" y="188" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#888">2A per channel</text>
  
  <!-- L298N pins -->
  <text x="883" y="135" font-family="Arial, sans-serif" font-size="7" fill="#333">IN1</text>
  <text x="883" y="150" font-family="Arial, sans-serif" font-size="7" fill="#333">IN2</text>
  <text x="883" y="165" font-family="Arial, sans-serif" font-size="7" fill="#333">IN3</text>
  <text x="883" y="180" font-family="Arial, sans-serif" font-size="7" fill="#333">IN4</text>
  
  <text x="988" y="135" font-family="Arial, sans-serif" font-size="7" fill="#333">OUT1</text>
  <text x="988" y="150" font-family="Arial, sans-serif" font-size="7" fill="#333">OUT2</text>
  <text x="988" y="165" font-family="Arial, sans-serif" font-size="7" fill="#333">OUT3</text>
  <text x="988" y="180" font-family="Arial, sans-serif" font-size="7" fill="#333">OUT4</text>
  
  <!-- Driver input connections -->
  <line x1="810" y1="255" x2="835" y2="255" stroke="#ff5722" stroke-width="1.5"/>
  <line x1="835" y1="255" x2="835" y2="130" stroke="#ff5722" stroke-width="1.5"/>
  <line x1="835" y1="130" x2="880" y2="130" stroke="#ff5722" stroke-width="1.5"/>
  
  <line x1="810" y1="275" x2="845" y2="275" stroke="#ff5722" stroke-width="1.5"/>
  <line x1="845" y1="275" x2="845" y2="145" stroke="#ff5722" stroke-width="1.5"/>
  <line x1="845" y1="145" x2="880" y2="145" stroke="#ff5722" stroke-width="1.5"/>
  
  <line x1="810" y1="295" x2="855" y2="295" stroke="#ff5722" stroke-width="1.5"/>
  <line x1="855" y1="295" x2="855" y2="160" stroke="#ff5722" stroke-width="1.5"/>
  <line x1="855" y1="160" x2="880" y2="160" stroke="#ff5722" stroke-width="1.5"/>
  
  <line x1="810" y1="315" x2="865" y2="315" stroke="#ff5722" stroke-width="1.5"/>
  <line x1="865" y1="315" x2="865" y2="175" stroke="#ff5722" stroke-width="1.5"/>
  <line x1="865" y1="175" x2="880" y2="175" stroke="#ff5722" stroke-width="1.5"/>
  
  <!-- Motor A symbol -->
  <circle cx="1060" cy="140" r="25" fill="none" stroke="#333" stroke-width="2"/>
  <text x="1060" y="145" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">M1</text>
  <line x1="1000" y1="130" x2="1035" y2="130" stroke="#333" stroke-width="1.5"/>
  <line x1="1000" y1="150" x2="1035" y2="150" stroke="#333" stroke-width="1.5"/>
  <text x="1060" y="175" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666">Left Motor</text>
  
  <!-- Motor B symbol -->
  <circle cx="1060" cy="230" r="25" fill="none" stroke="#333" stroke-width="2"/>
  <text x="1060" y="235" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">M2</text>
  <line x1="1000" y1="220" x2="1035" y2="220" stroke="#333" stroke-width="1.5"/>
  <line x1="1000" y1="240" x2="1035" y2="240" stroke="#333" stroke-width="1.5"/>
  <text x="1060" y="265" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666">Right Motor</text>
  
  <!-- Motor connections -->
  <line x1="1000" y1="130" x2="1000" y2="125" stroke="#333" stroke-width="1.5"/>
  <line x1="1000" y1="150" x2="1000" y2="155" stroke="#333" stroke-width="1.5"/>
  <line x1="1000" y1="220" x2="1000" y2="215" stroke="#333" stroke-width="1.5"/>
  <line x1="1000" y1="240" x2="1000" y2="245" stroke="#333" stroke-width="1.5"/>
  
  <!-- Power to motor driver -->
  <line x1="200" y1="145" x2="200" y2="80" stroke="#d32f2f" stroke-width="2"/>
  <line x1="200" y1="80" x2="940" y2="80" stroke="#d32f2f" stroke-width="2"/>
  <line x1="940" y1="80" x2="940" y2="120" stroke="#d32f2f" stroke-width="2"/>
  <text x="940" y="115" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#d32f2f">VCC 24V</text>
  
  <!-- ==================== SECTION 5: IR RECEIVER ==================== -->
  <rect x="850" y="300" width="140" height="110" rx="8" fill="#e8eaf6" stroke="#3f51b5" stroke-width="2"/>
  <text x="920" y="320" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#3f51b5">IR 수신부</text>
  
  <!-- IR Receiver IC (U3) -->
  <rect x="870" y="335" width="100" height="50" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="920" y="360" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">S033 PHVG</text>
  <text x="920" y="375" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">U3 - 825Y</text>
  
  <!-- IR connection to MCU -->
  <line x1="870" y1="355" x2="830" y2="355" stroke="#3f51b5" stroke-width="1.5"/>
  <line x1="830" y1="355" x2="830" y2="235" stroke="#3f51b5" stroke-width="1.5"/>
  <line x1="830" y1="235" x2="810" y2="235" stroke="#3f51b5" stroke-width="1.5"/>
  
  <!-- ==================== SECTION 6: MOSFET ARRAY ==================== -->
  <rect x="1000" y="300" width="140" height="110" rx="8" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2"/>
  <text x="1070" y="320" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#7b1fa2">MOSFET 어레이</text>
  
  <!-- MOSFET symbols -->
  <rect x="1020" y="335" width="100" height="50" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="1070" y="355" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">HY3D (Q1-Q15)</text>
  <text x="1070" y="372" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">N-ch MOSFET Array</text>
  
  <!-- ==================== SECTION 7: LED INDICATORS ==================== -->
  <rect x="20" y="250" width="200" height="120" rx="8" fill="#fff8e1" stroke="#ff8f00" stroke-width="2"/>
  <text x="120" y="270" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#ff8f00">상태 표시 LED</text>
  
  <!-- LEDs -->
  <circle cx="50" cy="310" r="8" fill="#4caf50" stroke="#333" stroke-width="1"/>
  <text x="50" y="335" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#333">LED1</text>
  <text x="50" y="347" font-family="Arial, sans-serif" font-size="7" text-anchor="middle" fill="#666">Power</text>
  
  <circle cx="90" cy="310" r="8" fill="#2196f3" stroke="#333" stroke-width="1"/>
  <text x="90" y="335" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#333">LED2</text>
  <text x="90" y="347" font-family="Arial, sans-serif" font-size="7" text-anchor="middle" fill="#666">Status</text>
  
  <circle cx="130" cy="310" r="8" fill="#ff9800" stroke="#333" stroke-width="1"/>
  <text x="130" y="335" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#333">LED3</text>
  <text x="130" y="347" font-family="Arial, sans-serif" font-size="7" text-anchor="middle" fill="#666">Motor</text>
  
  <circle cx="170" cy="310" r="8" fill="#f44336" stroke="#333" stroke-width="1"/>
  <text x="170" y="335" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#333">LED4</text>
  <text x="170" y="347" font-family="Arial, sans-serif" font-size="7" text-anchor="middle" fill="#666">Error</text>
  
  <circle cx="200" cy="310" r="8" fill="#9c27b0" stroke="#333" stroke-width="1"/>
  <text x="200" y="335" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#333">LED5</text>
  <text x="200" y="347" font-family="Arial, sans-serif" font-size="7" text-anchor="middle" fill="#666">IR</text>
  
  <!-- LED connection to MCU -->
  <line x1="200" y1="302" x2="200" y2="255" stroke="#8bc34a" stroke-width="1.5"/>
  <line x1="200" y1="255" x2="530" y2="255" stroke="#8bc34a" stroke-width="1.5"/>
  <line x1="530" y1="255" x2="545" y2="255" stroke="#8bc34a" stroke-width="1.5"/>
  <line x1="545" y1="255" x2="810" y2="255" stroke="#8bc34a" stroke-width="1.5"/>
  
  <!-- ==================== SECTION 8: ENCODER FEEDBACK ==================== -->
  <rect x="20" y="385" width="200" height="120" rx="8" fill="#e0f7fa" stroke="#00acc1" stroke-width="2"/>
  <text x="120" y="405" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#00acc1">엔코더 피드백</text>
  
  <!-- Encoder symbols -->
  <rect x="40" y="420" width="70" height="40" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="75" y="442" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">ENC1</text>
  <text x="75" y="470" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">Left Encoder</text>
  
  <rect x="130" y="420" width="70" height="40" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="165" y="442" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">ENC2</text>
  <text x="165" y="470" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">Right Encoder</text>
  
  <!-- Encoder to MCU connection -->
  <line x1="110" y1="440" x2="130" y2="440" stroke="#9c27b0" stroke-width="1.5"/>
  <line x1="200" y1="440" x2="220" y2="440" stroke="#9c27b0" stroke-width="1.5"/>
  <line x1="220" y1="440" x2="220" y2="380" stroke="#9c27b0" stroke-width="1.5"/>
  <line x1="220" y1="380" x2="480" y2="380" stroke="#9c27b0" stroke-width="1.5"/>
  <line x1="480" y1="380" x2="480" y2="175" stroke="#9c27b0" stroke-width="1.5"/>
  <line x1="480" y1="175" x2="550" y2="175" stroke="#9c27b0" stroke-width="1.5"/>
  
  <!-- ==================== SECTION 9: COMMUNICATION ==================== -->
  <rect x="230" y="385" width="280" height="120" rx="8" fill="#efebe9" stroke="#795548" stroke-width="2"/>
  <text x="370" y="405" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#795548">통신 인터페이스</text>
  
  <!-- UART -->
  <rect x="250" y="420" width="80" height="40" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="290" y="442" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">UART2</text>
  <text x="290" y="470" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">Debug/BT</text>
  
  <!-- I2C -->
  <rect x="350" y="420" width="70" height="40" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="385" y="442" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">I2C</text>
  <text x="385" y="470" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">Sensors</text>
  
  <!-- SWD -->
  <rect x="440" y="420" width="60" height="40" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="470" y="442" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">SWD</text>
  <text x="470" y="470" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#666">Debug</text>
  
  <!-- Comm to MCU connections -->
  <line x1="290" y1="420" x2="290" y2="370" stroke="#009688" stroke-width="1.5"/>
  <line x1="290" y1="370" x2="460" y2="370" stroke="#009688" stroke-width="1.5"/>
  <line x1="460" y1="370" x2="460" y2="215" stroke="#009688" stroke-width="1.5"/>
  <line x1="460" y1="215" x2="550" y2="215" stroke="#009688" stroke-width="1.5"/>
  
  <line x1="385" y1="420" x2="385" y2="360" stroke="#607d8b" stroke-width="1.5"/>
  <line x1="385" y1="360" x2="820" y2="360" stroke="#607d8b" stroke-width="1.5"/>
  <line x1="820" y1="360" x2="820" y2="185" stroke="#607d8b" stroke-width="1.5"/>
  <line x1="810" y1="175" x2="820" y2="175" stroke="#607d8b" stroke-width="1.5"/>
  <line x1="820" y1="175" x2="820" y2="195" stroke="#607d8b" stroke-width="1.5"/>
  <line x1="810" y1="195" x2="820" y2="195" stroke="#607d8b" stroke-width="1.5"/>
  
  <line x1="470" y1="420" x2="470" y2="350" stroke="#00bcd4" stroke-width="1.5"/>
  <line x1="470" y1="350" x2="825" y2="350" stroke="#00bcd4" stroke-width="1.5"/>
  <line x1="825" y1="350" x2="825" y2="285" stroke="#00bcd4" stroke-width="1.5"/>
  <line x1="810" y1="275" x2="825" y2="275" stroke="#00bcd4" stroke-width="1.5"/>
  <line x1="825" y1="275" x2="825" y2="295" stroke="#00bcd4" stroke-width="1.5"/>
  <line x1="810" y1="295" x2="825" y2="295" stroke="#00bcd4" stroke-width="1.5"/>
  
  <!-- ==================== SECTION 10: CURRENT SENSING ==================== -->
  <rect x="1140" y="85" width="120" height="120" rx="8" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
  <text x="1200" y="105" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#c62828">전류 센싱</text>
  
  <!-- Current sense resistors -->
  <rect x="1160" y="120" width="80" height="30" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="1200" y="140" font-family="Arial, sans-serif" font-size="9" font-weight="bold" text-anchor="middle" fill="#333">0.1Ω Shunt</text>
  
  <rect x="1160" y="160" width="80" height="30" rx="3" fill="white" stroke="#333" stroke-width="1.5"/>
  <text x="1200" y="180" font-family="Arial, sans-serif" font-size="9" font-weight="bold" text-anchor="middle" fill="#333">INA219</text>
  
  <!-- Current sense to ADC -->
  <line x1="1160" y1="175" x2="1130" y2="175" stroke="#795548" stroke-width="1.5"/>
  <line x1="1130" y1="175" x2="1130" y2="135" stroke="#795548" stroke-width="1.5"/>
  <line x1="810" y1="135" x2="1130" y2="135" stroke="#795548" stroke-width="1.5"/>
  
  <!-- ==================== GND RAIL ==================== -->
  <line x1="50" y1="530" x2="1350" y2="530" stroke="#333" stroke-width="4"/>
  <text x="700" y="555" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">GND</text>
  
  <!-- GND symbols -->
  <line x1="240" y1="210" x2="240" y2="530" stroke="#333" stroke-width="1"/>
  <line x1="550" y1="335" x2="550" y2="530" stroke="#333" stroke-width="1"/>
  <line x1="940" y1="200" x2="940" y2="530" stroke="#333" stroke-width="1"/>
  
  <!-- Ground triangles -->
  <polygon points="235,525 245,525 240,535" fill="#333"/>
  <polygon points="545,525 555,525 550,535" fill="#333"/>
  <polygon points="935,525 945,525 940,535" fill="#333"/>
  
  <!-- ==================== TEST POINTS ==================== -->
  <rect x="1140" y="220" width="120" height="90" rx="8" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>
  <text x="1200" y="240" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#2e7d32">테스트 포인트</text>
  
  <circle cx="1160" cy="260" r="5" fill="#4caf50" stroke="#333" stroke-width="1"/>
  <text x="1175" y="263" font-family="Arial, sans-serif" font-size="8" fill="#333">TP1-24V</text>
  
  <circle cx="1160" cy="280" r="5" fill="#ff9800" stroke="#333" stroke-width="1"/>
  <text x="1175" y="283" font-family="Arial, sans-serif" font-size="8" fill="#333">TP3-12V</text>
  
  <circle cx="1160" cy="300" r="5" fill="#2196f3" stroke="#333" stroke-width="1"/>
  <text x="1175" y="303" font-family="Arial, sans-serif" font-size="8" fill="#333">TP9-3.3V</text>
  
  <!-- ==================== BOM REFERENCE ==================== -->
  <rect x="520" y="420" width="320" height="95" rx="8" fill="#fafafa" stroke="#9e9e9e" stroke-width="1"/>
  <text x="680" y="440" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">BOM Reference</text>
  
  <text x="535" y="460" font-family="monospace" font-size="9" fill="#333">D1: SS24 (Schottky Diode)</text>
  <text x="535" y="475" font-family="monospace" font-size="9" fill="#333">D2: MCC ME (Rectifier)</text>
  <text x="535" y="490" font-family="monospace" font-size="9" fill="#333">C1: 100µF 35V (Electrolytic)</text>
  <text x="535" y="505" font-family="monospace" font-size="9" fill="#333">U1: 7805 (5V Regulator)</text>
  
  <text x="720" y="460" font-family="monospace" font-size="9" fill="#333">U3: S033 PHVG 825Y (IR)</text>
  <text x="720" y="475" font-family="monospace" font-size="9" fill="#333">Q1-Q15: HY3D (N-ch MOSFET)</text>
  <text x="720" y="490" font-family="monospace" font-size="9" fill="#333">LED1-5: Status Indicators</text>
  <text x="720" y="505" font-family="monospace" font-size="9" fill="#333">TP1-13: Test Points</text>
  
  <!-- ==================== LEGEND ==================== -->
  <rect x="1150" y="420" width="110" height="95" rx="5" fill="white" stroke="#666" stroke-width="1"/>
  <text x="1205" y="438" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">Wire Legend</text>
  
  <line x1="1160" y1="455" x2="1190" y2="455" stroke="#d32f2f" stroke-width="2"/>
  <text x="1195" y="458" font-family="Arial, sans-serif" font-size="8" fill="#333">24V Power</text>
  
  <line x1="1160" y1="470" x2="1190" y2="470" stroke="#ff9800" stroke-width="2"/>
  <text x="1195" y="473" font-family="Arial, sans-serif" font-size="8" fill="#333">12V</text>
  
  <line x1="1160" y1="485" x2="1190" y2="485" stroke="#2196f3" stroke-width="2"/>
  <text x="1195" y="488" font-family="Arial, sans-serif" font-size="8" fill="#333">3.3V</text>
  
  <line x1="1160" y1="500" x2="1190" y2="500" stroke="#ff5722" stroke-width="2"/>
  <text x="1195" y="503" font-family="Arial, sans-serif" font-size="8" fill="#333">PWM</text>
  
  <!-- ==================== NOTES ==================== -->
  <rect x="20" y="570" width="520" height="130" rx="5" fill="#fffde7" stroke="#fbc02d" stroke-width="1"/>
  <text x="30" y="590" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#f57f17">설계 노트</text>
  <text x="30" y="610" font-family="Arial, sans-serif" font-size="10" fill="#333">• TIM1 CH1-CH4: PWM 모터 제어 (4채널 독립 제어)</text>
  <text x="30" y="625" font-family="Arial, sans-serif" font-size="10" fill="#333">• TIM2 CH1-CH2: 엔코더 입력 (QEI 모드)</text>
  <text x="30" y="640" font-family="Arial, sans-serif" font-size="10" fill="#333">• USART2: 디버그/블루투스 통신 (115200 bps)</text>
  <text x="30" y="655" font-family="Arial, sans-serif" font-size="10" fill="#333">• I2C1: 센서 인터페이스 (IMU, 거리센서 등)</text>
  <text x="30" y="670" font-family="Arial, sans-serif" font-size="10" fill="#333">• SWD: ST-Link 디버거 연결</text>
  <text x="30" y="685" font-family="Arial, sans-serif" font-size="10" fill="#333">• ADC: 전류/전압 모니터링 (모터 과부하 보호)</text>
  
  <!-- Revision info -->
  <rect x="560" y="570" width="250" height="130" rx="5" fill="#e3f2fd" stroke="#1976d2" stroke-width="1"/>
  <text x="570" y="590" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1565c0">변경 이력</text>
  <text x="570" y="610" font-family="Arial, sans-serif" font-size="10" fill="#333">Rev 1.0 - 초기 설계</text>
  <text x="570" y="625" font-family="Arial, sans-serif" font-size="10" fill="#333">• L298N 듀얼 H-Bridge 적용</text>
  <text x="570" y="640" font-family="Arial, sans-serif" font-size="10" fill="#333">• STM32F103C8T6 MCU 채택</text>
  <text x="570" y="655" font-family="Arial, sans-serif" font-size="10" fill="#333">• 엔코더 피드백 회로 추가</text>
  <text x="570" y="670" font-family="Arial, sans-serif" font-size="10" fill="#333">• 전류 센싱 모듈 통합</text>
  
  <!-- Author info -->
  <rect x="830" y="570" width="250" height="130" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1"/>
  <text x="840" y="590" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#6a1b9a">핀 할당 요약</text>
  <text x="840" y="610" font-family="monospace" font-size="9" fill="#333">PA0-1  : Encoder Input (TIM2)</text>
  <text x="840" y="625" font-family="monospace" font-size="9" fill="#333">PA2-3  : USART2 TX/RX</text>
  <text x="840" y="640" font-family="monospace" font-size="9" fill="#333">PA8-11 : Motor PWM (TIM1)</text>
  <text x="840" y="655" font-family="monospace" font-size="9" fill="#333">PB0-1  : ADC (Current Sense)</text>
  <text x="840" y="670" font-family="monospace" font-size="9" fill="#333">PB6-7  : I2C1 SCL/SDA</text>
  <text x="840" y="685" font-family="monospace" font-size="9" fill="#333">PC13   : Status LED</text>
  
  <!-- Copyright -->
  <text x="1350" y="690" font-family="Arial, sans-serif" font-size="10" text-anchor="end" fill="#666">© 2025 Robot Vacuum Project</text>
</svg>
