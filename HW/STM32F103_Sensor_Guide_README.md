# STM32F103 센서 학습 가이드

> 로봇청소기 개발 관점에서 분석한 37종 센서 모듈 학습 커리큘럼

## 📋 센서 요약 테이블

| No | 센서명 | 인터페이스 | 기능 요약 | 로봇청소기 활용 | 활용도 |
|:--:|--------|:----------:|-----------|-----------------|:------:|
| 1 | 조이스틱 모듈 | ADC (2ch) | X/Y축 아날로그 위치 + 버튼 입력 | 수동 조작 모드, 디버깅용 제어 | ★★☆ |
| 2 | 릴레이 모듈 | GPIO | 고전압/고전류 회로 ON/OFF 스위칭 | 메인 모터 전원 제어, 충전 회로 스위칭 | ★★★ |
| 3 | 고감도 소리센서 | ADC/GPIO | 음압 레벨 감지 (아날로그 출력) | 음성 명령 감지, 이상 소음 모니터링 | ★★☆ |
| 4 | 소형 소리센서 | GPIO | 소리 유무 감지 (디지털 출력) | 박수/호출 인식 시작 기능 | ★☆☆ |
| 5 | 트래킹 모듈 | GPIO | 라인 추적용 IR 반사 감지 (다채널) | 벽면 추적, 가장자리 청소 경로 | ★★★ |
| 6 | 장애물 감지센서 | GPIO | IR 반사 기반 근거리 장애물 감지 | 충돌 방지, 장애물 회피 | ★★★ |
| 7 | 불꽃감지 센서 | ADC/GPIO | 적외선 스펙트럼 화염 감지 | 안전 기능 (화재 감지 시 정지/알림) | ★★☆ |
| 8 | 리니어 홀센서 | ADC | 자기장 세기 아날로그 측정 | 도킹 스테이션 정밀 위치 정렬 | ★★★ |
| 9 | 터치센서 | GPIO | 정전식 터치 감지 | 상단 터치 버튼, 청소 시작/정지 | ★★☆ |
| 10 | 디지털 온도센서 | 1-Wire | 정밀 온도 측정 (DS18B20) | 모터/배터리 과열 모니터링 | ★★★ |
| 11 | 능동 부저 | GPIO | 내장 발진회로, 전원만으로 단일음 | 상태 알림음, 에러 경고 | ★★★ |
| 12 | 수동 부저 | PWM | 외부 PWM으로 다양한 주파수 음 생성 | 멜로디 알림, 음성 안내 대체 | ★★☆ |
| 13 | RGB LED | PWM (3ch) | 풀컬러 LED 색상 제어 | 상태 표시 (청소중/충전/에러) | ★★★ |
| 14 | SMD LED | GPIO | 표면실장형 단색 LED | 전원/동작 표시등 | ★☆☆ |
| 15 | 2색 LED | GPIO (2ch) | 적/녹 또는 적/청 2색 전환 | 배터리 상태 표시 (충전/방전) | ★★☆ |
| 16 | 소형 2색 LED | GPIO (2ch) | 소형 2색 LED | 센서 상태 인디케이터 | ★☆☆ |
| 17 | 리드 스위치 | GPIO | 자석 근접 시 ON/OFF | 먼지통 장착 감지 | ★★★ |
| 18 | 미니 리드 | GPIO | 소형 리드 스위치 | 브러시 커버 열림 감지 | ★★☆ |
| 19 | 심박센서 | ADC | 광용적맥파(PPG) 측정 | 해당없음 (의료/웨어러블용) | ☆☆☆ |
| 20 | 7색 LED | GPIO | 자동 색상 순환 LED | 데모/전시용 효과 | ★☆☆ |
| 21 | 레이저 모듈 | GPIO | 포인트 레이저 출력 | 벽면 거리 측정 보조 (LDS 연계) | ★★☆ |
| 22 | 버튼 스위치 | GPIO | 택트 스위치 입력 | 물리 버튼 (전원/모드선택) | ★★★ |
| 23 | 충격 스위치 | GPIO | 진동/충격 감지 | 충돌 감지, 낙하 감지 | ★★★ |
| 24 | 로터리 엔코더 | GPIO (2ch) | 회전량/방향 펄스 출력 | 바퀴 회전량 측정, 주행 거리 계산 | ★★★ |
| 25 | 매직 라이트컵 | ADC | 기울기에 따른 LED 밝기 변화 | 해당없음 (교육/장식용) | ☆☆☆ |
| 26 | 기울기 스위치 | GPIO | 특정 각도 이상 기울어짐 감지 | 들림 감지, 전복 방지 | ★★★ |
| 27 | 볼 스위치 | GPIO | 진동/움직임 감지 | 이동 중 감지, 절전 모드 해제 | ★★☆ |
| 28 | 토양 센서 | ADC | 수분/습도 저항 측정 | 물걸레 습도 감지 (물걸레 로봇) | ★★☆ |
| 29 | 온습도센서 | 1-Wire | 온도 + 습도 통합 측정 (DHT11/22) | 실내 환경 모니터링, 결로 방지 | ★★☆ |
| 30 | 아날로그 홀센서 | ADC | 자기장 세기 연속 측정 | 모터 위치 피드백, 브러시 회전 감지 | ★★★ |
| 31 | 홀 마그네틱 | GPIO | 자석 유무 디지털 감지 | 휠 회전 펄스, 충전 도킹 감지 | ★★★ |
| 32 | 온도 센서 (NTC) | ADC | 서미스터 기반 온도 측정 | 모터 온도 모니터링 | ★★☆ |
| 33 | 아날로그 온도센서 | ADC | LM35 등 전압출력 온도센서 | 배터리 온도 관리 | ★★☆ |
| 34 | IR 발신 모듈 | PWM/GPIO | 적외선 신호 송신 | 가상벽 송신, 리모컨 신호 출력 | ★★☆ |
| 35 | IR 수신 모듈 | GPIO | 적외선 신호 수신 (38kHz) | 리모컨 수신, 가상벽 인식 | ★★★ |
| 36 | 광센서 (포토레지스터) | ADC | 조도 측정 | 주변 밝기 감지, 야간 모드 전환 | ★★☆ |
| 37 | 포토인터럽트 모듈 | GPIO | 차광 슬릿 통과 펄스 감지 | 휠 엔코더, 브러시 회전 감지 | ★★★ |

> **활용도 범례**: ★★★ 필수/핵심 | ★★☆ 유용/권장 | ★☆☆ 보조/선택 | ☆☆☆ 해당없음

---

## 📖 센서별 상세 설명

### 1. 조이스틱 모듈
**인터페이스**: ADC 2채널 + GPIO 1채널

**동작 원리**
- X/Y축 각각 가변저항(Potentiometer)으로 구성
- 중립 위치에서 약 1.65V (VCC/2), 조작 시 0~3.3V 범위
- 중앙 푸시 버튼은 디지털 입력

**STM32F103 구현**
```c
// ADC1 채널 0, 1 사용 (PA0, PA1)
// 버튼은 PA2 (풀업 입력)
uint16_t x_val = HAL_ADC_GetValue(&hadc1);  // 0~4095
uint16_t y_val = HAL_ADC_GetValue(&hadc1);  // 0~4095
```

**로봇청소기 활용**
- 개발/테스트 단계에서 수동 주행 제어
- 서비스 모드 진입 시 메뉴 탐색
- 실제 제품에서는 거의 사용되지 않음

---

### 2. 릴레이 모듈
**인터페이스**: GPIO (디지털 출력)

**동작 원리**
- 전자석 코일에 전류 인가 시 기계적 접점 스위칭
- NO(Normally Open), NC(Normally Closed) 접점 제공
- 3.3V 로직으로 5V/12V/220V 회로 제어 가능

**STM32F103 구현**
```c
// PA3을 릴레이 제어 핀으로 사용
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_3, GPIO_PIN_SET);   // 릴레이 ON
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_3, GPIO_PIN_RESET); // 릴레이 OFF
```

**로봇청소기 활용**
- 메인 브러시 모터 전원 ON/OFF
- 흡입 모터 전원 스위칭
- 충전 회로 연결/차단
- 비상 정지 시 전원 차단

**주의사항**
- 릴레이 구동 시 역기전력 발생 → 다이오드 보호 필수
- 기계적 수명 제한 (약 10만회)

---

### 3. 고감도 소리센서
**인터페이스**: ADC (아날로그) + GPIO (디지털 스레시홀드)

**동작 원리**
- 일렉트릿 콘덴서 마이크(ECM) + 증폭회로
- 소리 음압을 전압 레벨로 변환
- 가변저항으로 감도 조절 가능

**STM32F103 구현**
```c
// 아날로그 출력으로 음압 레벨 측정
uint16_t sound_level = HAL_ADC_GetValue(&hadc1);

// 디지털 출력으로 임계값 초과 감지
if (HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_0) == GPIO_PIN_SET) {
    // 소리 감지됨
}
```

**로봇청소기 활용**
- 음성 명령 감지 트리거 (웨이크 워드 전 단계)
- 모터/기어 이상 소음 감지
- "청소 시작" 음성 인식 전처리

---

### 4. 소형 소리센서
**인터페이스**: GPIO (디지털 출력만)

**동작 원리**
- 비교기 회로로 임계값 초과 시 HIGH 출력
- 고감도 센서의 간소화 버전

**STM32F103 구현**
```c
// 단순 이벤트 감지
if (HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_1) == GPIO_PIN_SET) {
    start_cleaning();  // 박수로 시작
}
```

**로봇청소기 활용**
- 박수 두 번으로 청소 시작/정지
- 저가형 음성 반응 기능

---

### 5. 트래킹 모듈 (라인 트레이서)
**인터페이스**: GPIO (다채널, 보통 3~5채널)

**동작 원리**
- IR LED 발광 + 포토트랜지스터 수광 쌍
- 바닥면 반사율에 따라 HIGH/LOW 출력
- 검정선: 흡수 → LOW, 흰 바닥: 반사 → HIGH

**STM32F103 구현**
```c
// 5채널 트래킹 센서 읽기
uint8_t track[5];
track[0] = HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_0);
track[1] = HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_1);
// ... 
// 패턴 분석으로 위치 판단
```

**로봇청소기 활용**
- 벽면 가장자리 추적 청소
- 절벽(계단) 감지 (바닥 없으면 반사 없음)
- 카펫/바닥 경계 인식

---

### 6. 장애물 감지센서 (IR 근접센서)
**인터페이스**: GPIO (디지털 출력)

**동작 원리**
- IR LED 발광, 장애물에서 반사된 IR 감지
- 감지 거리 조절 가변저항 내장 (2~30cm)
- 장애물 있으면 LOW 출력 (Active Low가 일반적)

**STM32F103 구현**
```c
// 다방향 장애물 감지 (전방, 좌, 우)
if (HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_5) == GPIO_PIN_RESET) {
    // 전방 장애물 감지 → 정지 또는 회피
    avoid_obstacle();
}
```

**로봇청소기 활용**
- 가구/벽 충돌 전 감속
- 장애물 회피 주행 알고리즘
- 다중 센서로 360° 감지 구현

---

### 7. 불꽃감지 센서
**인터페이스**: ADC (아날로그) + GPIO (디지털)

**동작 원리**
- 760~1100nm 파장의 적외선 감지
- 화염의 특징적 IR 스펙트럼에 반응
- 감지 각도 약 60°, 거리 최대 1m

**STM32F103 구현**
```c
// 화염 감지 시 즉시 정지
if (HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_6) == GPIO_PIN_SET) {
    emergency_stop();
    send_fire_alert();
}
```

**로봇청소기 활용**
- 안전 기능: 화재 감지 시 즉시 정지 및 알림
- 스마트홈 연동 화재 경보
- 충전 중 과열/발화 감지

---

### 8. 리니어 홀센서
**인터페이스**: ADC (아날로그 출력)

**동작 원리**
- 홀 효과로 자기장 세기를 전압으로 변환
- 자기장 없을 때 VCC/2, N극/S극에 따라 증감
- 자석과의 거리에 비례한 출력

**STM32F103 구현**
```c
// 자기장 세기로 위치 판단
uint16_t hall_val = HAL_ADC_GetValue(&hadc1);
int16_t position = hall_val - 2048;  // 중심 기준 오프셋
```

**로봇청소기 활용**
- 충전 도킹 스테이션 정밀 정렬
- 도킹 시 mm 단위 위치 미세조정
- 자석 위치 기반 각도 측정

---

### 9. 터치센서
**인터페이스**: GPIO (디지털 출력)

**동작 원리**
- 정전용량 변화 감지 (TTP223 등)
- 손가락 접촉 시 정전용량 증가 → 트리거
- 터치 시 HIGH, 미접촉 시 LOW

**STM32F103 구현**
```c
// 터치 버튼 입력 처리
if (HAL_GPIO_ReadPin(GPIOC, GPIO_PIN_0) == GPIO_PIN_SET) {
    toggle_cleaning_mode();
}
```

**로봇청소기 활용**
- 본체 상단 터치 버튼 (물리 버튼 대체)
- 청소 시작/일시정지
- 모드 전환 (자동/스팟/가장자리)

---

### 10. 디지털 온도센서 (DS18B20)
**인터페이스**: 1-Wire (단일 데이터선)

**동작 원리**
- 디지털 출력, -55~125°C 범위
- 분해능 9~12bit 설정 가능 (0.5~0.0625°C)
- 고유 64bit ROM 코드로 다중 센서 연결 가능

**STM32F103 구현**
```c
// 1-Wire 프로토콜 구현 필요
DS18B20_Init();
DS18B20_StartConversion();
HAL_Delay(750);  // 12bit 변환 시간
float temp = DS18B20_ReadTemperature();
```

**로봇청소기 활용**
- 배터리 온도 모니터링 (과충전/과방전 방지)
- 모터 과열 보호
- 충전 중 온도 감시

---

### 11. 능동 부저 (Active Buzzer)
**인터페이스**: GPIO (디지털 출력)

**동작 원리**
- 내장 발진회로로 전원 인가만으로 고정 주파수 음 발생
- 보통 2~4kHz 고정음
- ON/OFF 제어만 가능

**STM32F103 구현**
```c
// 단순 비프음
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_8, GPIO_PIN_SET);
HAL_Delay(100);
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_8, GPIO_PIN_RESET);
```

**로봇청소기 활용**
- 청소 완료 알림
- 에러 경고음 (3회 연속 비프 등)
- 배터리 부족 경고

---

### 12. 수동 부저 (Passive Buzzer)
**인터페이스**: PWM (주파수 가변)

**동작 원리**
- 피에조 소자만 있고 발진회로 없음
- 외부에서 PWM 주파수로 음 높이 결정
- 멜로디, 다양한 알림음 구현 가능

**STM32F103 구현**
```c
// 다양한 주파수 음 생성
void play_tone(uint16_t frequency, uint16_t duration) {
    __HAL_TIM_SET_AUTORELOAD(&htim2, 1000000/frequency);
    __HAL_TIM_SET_COMPARE(&htim2, TIM_CHANNEL_1, 500000/frequency);
    HAL_TIM_PWM_Start(&htim2, TIM_CHANNEL_1);
    HAL_Delay(duration);
    HAL_TIM_PWM_Stop(&htim2, TIM_CHANNEL_1);
}
```

**로봇청소기 활용**
- 시작/종료 멜로디
- 상태별 구분 알림음
- 에러 코드별 다른 패턴

---

### 13. RGB LED
**인터페이스**: PWM 3채널 (또는 GPIO)

**동작 원리**
- Red, Green, Blue LED 통합 패키지
- 각 색상 PWM 듀티비로 밝기 조절
- 조합으로 풀컬러 표현 (16.7M 색상)

**STM32F103 구현**
```c
// 색상 설정 (0~255)
void set_rgb(uint8_t r, uint8_t g, uint8_t b) {
    __HAL_TIM_SET_COMPARE(&htim3, TIM_CHANNEL_1, r);
    __HAL_TIM_SET_COMPARE(&htim3, TIM_CHANNEL_2, g);
    __HAL_TIM_SET_COMPARE(&htim3, TIM_CHANNEL_3, b);
}
```

**로봇청소기 활용**
- 상태 표시: 청소중(녹색), 충전중(주황), 에러(빨강)
- 배터리 잔량 색상 표시
- 모드별 색상 구분

---

### 14. SMD LED
**인터페이스**: GPIO (디지털 출력)

**동작 원리**
- 표면실장형 소형 단색 LED
- 저항 내장형 또는 외부 저항 필요
- ON/OFF 제어

**STM32F103 구현**
```c
HAL_GPIO_WritePin(GPIOC, GPIO_PIN_13, GPIO_PIN_SET);  // LED ON
```

**로봇청소기 활용**
- 전원 표시등
- 센서 동작 확인용 인디케이터

---

### 15. 2색 LED
**인터페이스**: GPIO 2채널

**동작 원리**
- 공통 캐소드/애노드 타입
- 두 색상 개별 또는 동시 점등
- 동시 점등 시 혼합색 (적+녹=주황)

**STM32F103 구현**
```c
// 적색
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_0, GPIO_PIN_SET);
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_1, GPIO_PIN_RESET);
// 녹색
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_0, GPIO_PIN_RESET);
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_1, GPIO_PIN_SET);
// 주황 (둘 다 ON)
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_0, GPIO_PIN_SET);
HAL_GPIO_WritePin(GPIOA, GPIO_PIN_1, GPIO_PIN_SET);
```

**로봇청소기 활용**
- 배터리 상태 (녹색: 충분, 주황: 보통, 빨강: 부족)
- 충전 상태 표시

---

### 16. 소형 2색 LED
**인터페이스**: GPIO 2채널

**동작 원리**
- 2색 LED의 소형화 버전
- 공간 제약 있는 곳에 사용

**로봇청소기 활용**
- 개별 센서 상태 표시
- 디버깅용 인디케이터

---

### 17. 리드 스위치 (Reed Switch)
**인터페이스**: GPIO (디지털 입력, 풀업 필요)

**동작 원리**
- 유리관 내 자성 금속 접점
- 자석 근접 시 접점 붙음 → 도통
- 자석 제거 시 접점 분리 → 개방

**STM32F103 구현**
```c
// 풀업 저항 설정 후 읽기
if (HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_10) == GPIO_PIN_RESET) {
    // 자석 근접 (먼지통 장착됨)
    dust_bin_attached = true;
}
```

**로봇청소기 활용**
- 먼지통 장착 감지 (먼지통에 자석 부착)
- 물탱크 장착 감지
- 덮개 열림/닫힘 감지

---

### 18. 미니 리드 스위치
**인터페이스**: GPIO

**동작 원리**
- 리드 스위치의 소형화 버전
- 좁은 공간에 설치 가능

**로봇청소기 활용**
- 브러시 커버 열림 감지
- 사이드 브러시 장착 감지

---

### 19. 심박센서
**인터페이스**: ADC (아날로그 출력)

**동작 원리**
- 광용적맥파(PPG) 원리
- 녹색 LED 조사 후 반사광 측정
- 혈류량 변화로 심박 추출

**로봇청소기 활용**
- **해당없음** (웨어러블/의료 기기 전용)
- 임베디드 학습 목적으로는 ADC + 신호처리 연습에 활용

---

### 20. 7색 LED (자동 변환)
**인터페이스**: GPIO

**동작 원리**
- 내장 IC로 자동 색상 순환
- 전원 인가만으로 동작
- 제어 불가 (자동 모드만)

**로봇청소기 활용**
- 데모/전시 모드 장식 효과
- 실제 제품에서는 거의 사용 안 함

---

### 21. 레이저 모듈
**인터페이스**: GPIO (또는 PWM)

**동작 원리**
- 650nm 적색 레이저 다이오드
- 포인트 레이저 출력
- 밝기 PWM 조절 가능

**STM32F103 구현**
```c
HAL_GPIO_WritePin(GPIOB, GPIO_PIN_12, GPIO_PIN_SET);  // 레이저 ON
```

**로봇청소기 활용**
- LDS(Laser Distance Sensor) 보조
- 벽면 거리 측정용 광원
- 고급형 로봇청소기 SLAM 구성요소

**주의사항**
- 눈에 직접 조사 금지 (Class 2 이상 위험)

---

### 22. 버튼 스위치 (택트 스위치)
**인터페이스**: GPIO (풀업/풀다운 입력)

**동작 원리**
- 누르면 도통, 떼면 개방
- 바운싱 현상 발생 → 디바운싱 처리 필요
- 4핀 구조 (2핀씩 내부 연결)

**STM32F103 구현**
```c
// 소프트웨어 디바운싱
uint8_t read_button_debounced(void) {
    static uint32_t last_time = 0;
    if (HAL_GetTick() - last_time < 50) return 0;
    if (HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_5) == GPIO_PIN_RESET) {
        last_time = HAL_GetTick();
        return 1;
    }
    return 0;
}
```

**로봇청소기 활용**
- 전원 버튼
- 청소 시작/정지 버튼
- 모드 선택 버튼

---

### 23. 충격 스위치 (Shock/Vibration Sensor)
**인터페이스**: GPIO

**동작 원리**
- 내부 스프링 또는 볼이 진동 시 접점 터치
- 충격/진동 시 순간적 펄스 발생
- 외부 인터럽트로 감지

**STM32F103 구현**
```c
// EXTI 인터럽트로 충격 감지
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin) {
    if (GPIO_Pin == GPIO_PIN_6) {
        collision_detected = true;
    }
}
```

**로봇청소기 활용**
- 범퍼 충돌 감지
- 낙하/전복 감지
- 이상 진동 모니터링

---

### 24. 로터리 엔코더
**인터페이스**: GPIO 2채널 (A, B 펄스)

**동작 원리**
- 회전 시 90° 위상차 2채널 펄스 출력
- A, B 위상 순서로 회전 방향 판단
- 펄스 카운트로 회전량 측정

**STM32F103 구현**
```c
// 타이머 엔코더 모드 활용
HAL_TIM_Encoder_Start(&htim2, TIM_CHANNEL_ALL);
int32_t count = __HAL_TIM_GET_COUNTER(&htim2);
```

**로봇청소기 활용**
- 바퀴 회전량 측정 → 주행 거리 계산
- 오도메트리 (위치 추정)
- 속도 제어 피드백

---

### 25. 매직 라이트컵
**인터페이스**: ADC

**동작 원리**
- 수은 스위치 + LED 조합
- 기울기에 따라 LED 밝기 변화
- 교육/장식용 모듈

**로봇청소기 활용**
- **해당없음** (교육/장식 전용)
- ADC 읽기 연습용

---

### 26. 기울기 스위치 (Tilt Switch)
**인터페이스**: GPIO

**동작 원리**
- 내부 금속 볼이 중력에 따라 이동
- 특정 각도 이상 기울어지면 접점 ON/OFF
- 수은 스위치의 안전한 대체품

**STM32F103 구현**
```c
if (HAL_GPIO_ReadPin(GPIOB, GPIO_PIN_14) == GPIO_PIN_SET) {
    // 로봇이 들어올려짐 → 휠 정지
    stop_wheels();
}
```

**로봇청소기 활용**
- 들림 감지 (청소 중 사용자가 들어올림 → 휠 정지)
- 전복 감지
- 경사면 감지

---

### 27. 볼 스위치 (Ball Switch)
**인터페이스**: GPIO

**동작 원리**
- 기울기 스위치와 유사
- 미세한 움직임/진동에도 반응
- 더 민감한 감지

**로봇청소기 활용**
- 움직임 감지 → 절전 모드 해제
- 진동 기반 동작 상태 확인

---

### 28. 토양 센서 (Soil Moisture Sensor)
**인터페이스**: ADC

**동작 원리**
- 두 전극 사이 저항 측정
- 수분 많을수록 저항 감소 → 전압 상승
- 원래 용도는 화분 흙 수분 측정

**STM32F103 구현**
```c
uint16_t moisture = HAL_ADC_GetValue(&hadc1);
// 값이 높을수록 습함
```

**로봇청소기 활용**
- 물걸레 로봇: 걸레 습도 감지
- 물탱크 물 유무 감지
- 바닥 젖음 감지

---

### 29. 온습도센서 (DHT11/DHT22)
**인터페이스**: 1-Wire (자체 프로토콜)

**동작 원리**
- 정전용량식 습도 센서 + NTC 온도 센서
- 40bit 데이터 (습도 정수/소수, 온도 정수/소수, 체크섬)
- DHT22가 더 정밀 (0.1단위)

**STM32F103 구현**
```c
// 시작 신호 후 응답 및 데이터 수신
DHT11_Start();
uint8_t data[5];
DHT11_Read(data);
float humidity = data[0] + data[1]*0.1;
float temperature = data[2] + data[3]*0.1;
```

**로봇청소기 활용**
- 실내 환경 모니터링
- 습도 높은 날 물걸레 모드 자동 전환
- 결로 방지 알고리즘

---

### 30. 아날로그 홀센서
**인터페이스**: ADC

**동작 원리**
- 리니어 홀센서와 동일
- 자기장 세기에 비례한 아날로그 출력
- 연속적인 위치/각도 측정

**로봇청소기 활용**
- BLDC 모터 위치 피드백
- 브러시 회전 속도 측정
- 자석 기반 정밀 위치 제어

---

### 31. 홀 마그네틱 센서 (디지털)
**인터페이스**: GPIO

**동작 원리**
- 자석 감지 시 LOW, 미감지 시 HIGH
- 온/오프 스위칭 용도
- 히스테리시스로 안정적 동작

**STM32F103 구현**
```c
// 휠 회전 펄스 카운트
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin) {
    if (GPIO_Pin == GPIO_PIN_0) {
        wheel_pulse_count++;
    }
}
```

**로봇청소기 활용**
- 바퀴에 자석 부착 → 회전 펄스 감지
- 충전 도킹 위치 감지
- 모터 1회전 기준점

---

### 32. 온도 센서 (NTC 서미스터)
**인터페이스**: ADC

**동작 원리**
- 온도 상승 시 저항 감소 (NTC: Negative Temperature Coefficient)
- 분압 회로로 전압 변환 후 ADC 측정
- Steinhart-Hart 방정식으로 온도 계산

**STM32F103 구현**
```c
uint16_t adc_val = HAL_ADC_GetValue(&hadc1);
float resistance = 10000.0 * adc_val / (4095 - adc_val);
float temp = 1.0 / (log(resistance/10000)/3950 + 1.0/298.15) - 273.15;
```

**로봇청소기 활용**
- 모터 온도 모니터링
- 방열판 온도 측정
- 과열 보호 시스템

---

### 33. 아날로그 온도센서 (LM35 등)
**인터페이스**: ADC

**동작 원리**
- 10mV/°C 선형 출력
- 0°C에서 0V, 25°C에서 250mV
- 별도 계산 없이 바로 온도 환산

**STM32F103 구현**
```c
uint16_t adc_val = HAL_ADC_GetValue(&hadc1);
float voltage = adc_val * 3.3 / 4095;
float temp = voltage / 0.01;  // 10mV/°C
```

**로봇청소기 활용**
- 배터리 온도 관리 (충전/방전 시)
- 제어 보드 온도 모니터링

---

### 34. IR 발신 모듈
**인터페이스**: PWM (38kHz 캐리어) 또는 GPIO

**동작 원리**
- 940nm 적외선 LED
- 38kHz 캐리어에 데이터 변조
- NEC, RC5 등 프로토콜 사용

**STM32F103 구현**
```c
// 38kHz 캐리어 생성 (26.3μs 주기)
// TIM PWM으로 캐리어 생성 후 데이터 변조
HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_1);
// NEC 프로토콜 데이터 송신
```

**로봇청소기 활용**
- 가상벽 송신기 구현
- 다른 로봇과 통신
- 테스트용 리모컨 신호 생성

---

### 35. IR 수신 모듈
**인터페이스**: GPIO (디지털 펄스)

**동작 원리**
- 38kHz IR 신호 수신 및 복조
- 복조된 디지털 펄스 출력
- VS1838B, TSOP38238 등

**STM32F103 구현**
```c
// 타이머 인풋 캡처로 펄스 폭 측정
// NEC 프로토콜 디코딩
void decode_ir_signal(void) {
    // 9ms 리더 + 4.5ms 스페이스 감지
    // 32bit 데이터 디코딩
}
```

**로봇청소기 활용**
- 리모컨 수신
- 가상벽 신호 인식 (진입 금지 구역)
- 충전 스테이션 IR 비콘 감지

---

### 36. 광센서 (포토레지스터/CdS)
**인터페이스**: ADC

**동작 원리**
- 빛이 강할수록 저항 감소
- 분압 회로로 전압 변환
- 수 kΩ(밝음) ~ 수 MΩ(어두움)

**STM32F103 구현**
```c
uint16_t light = HAL_ADC_GetValue(&hadc1);
// 값이 높을수록 밝음
```

**로봇청소기 활용**
- 주변 밝기 감지 → 야간 모드 전환
- 어두운 곳에서 LED 조명 자동 점등
- 에너지 절약 (어두우면 디스플레이 OFF)

---

### 37. 포토인터럽트 모듈
**인터페이스**: GPIO

**동작 원리**
- U자형 센서, 발광부-수광부 분리
- 슬릿/물체 통과 시 차광 → 펄스 발생
- 인코더 디스크와 함께 사용

**STM32F103 구현**
```c
// 외부 인터럽트로 펄스 카운트
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin) {
    if (GPIO_Pin == GPIO_PIN_7) {
        encoder_count++;
    }
}
```

**로봇청소기 활용**
- 휠 엔코더 (슬릿 디스크 조합)
- 메인 브러시 회전 감지
- 사이드 브러시 회전 확인

---

## 📚 학습 순서 추천

### Phase 1: GPIO 기초
1. 버튼 스위치 → 디지털 입력, 디바운싱
2. SMD LED → 디지털 출력
3. 능동 부저 → 출력 타이밍 제어

### Phase 2: ADC 활용
4. 조이스틱 → 멀티채널 ADC
5. 광센서 → 단일 ADC + 조건문
6. 아날로그 온도센서 → ADC 캘리브레이션

### Phase 3: PWM 출력
7. RGB LED → 멀티채널 PWM
8. 수동 부저 → 가변 주파수 PWM

### Phase 4: 디지털 통신
9. 디지털 온도센서 → 1-Wire 프로토콜
10. 온습도센서 → 자체 프로토콜 구현

### Phase 5: 인터럽트 활용
11. 충격 스위치 → EXTI 인터럽트
12. 로터리 엔코더 → 타이머 엔코더 모드
13. 포토인터럽트 → 고속 펄스 카운팅

### Phase 6: 센서 융합
14. IR 발신 + 수신 → 양방향 통신
15. 장애물 감지 + 트래킹 → 복합 주행 알고리즘

---

## 🔧 개발 환경

- **MCU**: STM32F103C8T6 (Blue Pill)
- **IDE**: STM32CubeIDE
- **HAL**: STM32 HAL Library
- **디버거**: ST-Link V2

---

## 📄 라이선스

MIT License

---

## 📞 참고자료

- [STM32F103 Reference Manual](https://www.st.com/resource/en/reference_manual/rm0008-stm32f101xxstm32f102xxstm32f103xx-and-stm32f105xxstm32f107xx-advanced-armbased-32bit-mcus-stmicroelectronics.pdf)
- [HAL Library Documentation](https://www.st.com/resource/en/user_manual/um1785-stm32-hal-and-low-layer-drivers-stmicroelectronics.pdf)
